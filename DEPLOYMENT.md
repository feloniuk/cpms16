# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é IT Support Bot

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ

–°–æ–∑–¥–∞–ª–∏ –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞:
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ SQL —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞  
- ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã –±–æ—Ç–∞ –Ω–∞–ø–∏—Å–∞–Ω—ã
- ‚úÖ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ Webhook –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–æ—Ç–æ–≤

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–∞—Ö

### 1. –û–±–Ω–æ–≤–∏—Ç–µ config/telegram.php
–ó–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é (—Å–º. –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤—ã—à–µ) - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω webhook_url.

### 2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ñ–∞–π–ª—ã
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ –∫–ª–∞—Å—Å—ã –∏–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞–ø–∫–∏.

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞

### –®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î
```bash
cd /var/www/html
mysql -u u442651334_main -p u442651334_main < sql/database.sql
```

### –®–∞–≥ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
php test_db.php
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞
1. –ù–∞–ø–∏—à–∏—Ç–µ **@BotFather** –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: `IT Support Bot` 
4. –£–∫–∞–∂–∏—Ç–µ username: `your_company_support_bot` (–∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π)
5. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ **—Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ!**

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config/telegram.php`:
```php
'bot_token' => '–í–ê–®_–¢–û–ö–ï–ù_–û–¢_BOTFATHER',
```

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook
```bash
php setup_webhook.php
```

### –®–∞–≥ 6: –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∞—à–µ–≥–æ Telegram ID

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –ß–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –±–æ—Ç–æ–≤**
- –ù–∞–ø–∏—à–∏—Ç–µ @userinfobot –∏–ª–∏ @getmyid_bot

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –ß–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç**
```bash
# 1. –í—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤—å—Ç–µ webhook
curl -X POST "https://api.telegram.org/bot–í–ê–®_–¢–û–ö–ï–ù/setWebhook" \
     -d "url=https://cpms16.online/get_my_id.php"

# 2. –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
# 3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ ID –≤ —Ñ–∞–π–ª–µ logs/telegram_ids.log
# 4. –í–µ—Ä–Ω–∏—Ç–µ webhook –æ–±—Ä–∞—Ç–Ω–æ
curl -X POST "https://api.telegram.org/bot–í–ê–®_–¢–û–ö–ï–ù/setWebhook" \
     -d "url=https://cpms16.online/telegram-bot/webhook.php"

# 5. –£–î–ê–õ–ò–¢–ï get_my_id.php!
rm get_my_id.php
```

### –®–∞–≥ 7: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–±—è –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
```bash
php add_admin.php –í–ê–®_TELEGRAM_ID "–í–∞—à–µ –ò–º—è"
# –ü—Ä–∏–º–µ—Ä: php add_admin.php 123456789 "–ò–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ"
```

### –®–∞–≥ 8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞
1. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram
2. –ù–∞–ø–∏—à–∏—Ç–µ `/start`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—è–≤–∏–ª–æ—Å—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/admin` - –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å

```
/var/www/html/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ Database.php ‚úÖ
‚îÇ   ‚îî‚îÄ‚îÄ repositories/
‚îÇ       ‚îú‚îÄ‚îÄ BaseRepository.php ‚úÖ
‚îÇ       ‚îú‚îÄ‚îÄ BranchRepository.php ‚úÖ
‚îÇ       ‚îú‚îÄ‚îÄ AdminRepository.php ‚úÖ
‚îÇ       ‚îî‚îÄ‚îÄ UserStateRepository.php ‚úÖ
‚îú‚îÄ‚îÄ telegram-bot/
‚îÇ   ‚îú‚îÄ‚îÄ TelegramBot.php ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ webhook.php ‚úÖ (–æ–±–Ω–æ–≤–∏—Ç—å)
‚îÇ   ‚îî‚îÄ‚îÄ keyboards/
‚îÇ       ‚îî‚îÄ‚îÄ Keyboards.php ‚úÖ
‚îú‚îÄ‚îÄ test_db.php ‚úÖ
‚îú‚îÄ‚îÄ setup_webhook.php ‚úÖ
‚îú‚îÄ‚îÄ add_admin.php ‚úÖ
‚îú‚îÄ‚îÄ get_my_id.php ‚úÖ (–≤—Ä–µ–º–µ–Ω–Ω—ã–π)
‚îî‚îÄ‚îÄ DEPLOYMENT.md ‚úÖ
```

## üîç –û—Ç–ª–∞–¥–∫–∞ –∏ –ª–æ–≥–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –õ–æ–≥–∏ webhook
tail -f logs/webhook.log

# –õ–æ–≥–∏ –±–æ—Ç–∞
tail -f logs/telegram.log

# –õ–æ–≥–∏ –æ—à–∏–±–æ–∫
tail -f logs/errors.log

# –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤
echo "" > logs/webhook.log
echo "" > logs/telegram.log
echo "" > logs/errors.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook
```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ webhook
curl "https://api.telegram.org/bot–í–ê–®_–¢–û–ö–ï–ù/getWebhookInfo"

# –¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ webhook
curl -X POST "https://cpms16.online/telegram-bot/webhook.php" \
     -H "Content-Type: application/json" \
     -d '{"test": true}'
```

## ‚ùå –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "Database connection failed"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `config/database.php`

### –ü—Ä–æ–±–ª–µ–º–∞: "Invalid JSON" –≤ –ª–æ–≥–∞—Ö webhook
**–†–µ—à–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ webhook URL –¥–æ—Å—Ç—É–ø–µ–Ω
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ PHP

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook: `curl "https://api.telegram.org/bot–¢–û–ö–ï–ù/getWebhookInfo"`
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "–£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π Telegram ID –≤ —Ç–∞–±–ª–∏—Ü—É admins

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
   ```bash
   php test_db.php
   ```

2. **Webhook:**
   ```bash
   php setup_webhook.php
   ```

3. **–ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç:**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É
   - –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

4. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/admin` –±–æ—Ç—É
   - –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –º–µ–Ω—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –º–æ–∂–Ω–æ:
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫ –Ω–∞ —Ä–µ–º–æ–Ω—Ç
2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –∑–∞–º–µ–Ω—É –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π  
3. –î–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
4. –†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å REST API (—Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø)

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –ø–∞–ø–∫–µ `logs/`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ë–î –∏ Telegram

**–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–∞—Ö!** üöÄ